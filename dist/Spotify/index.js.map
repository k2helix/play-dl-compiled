{"version":3,"file":"index.js","sourceRoot":"","sources":["../../play-dl/Spotify/index.ts"],"names":[],"mappings":"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","sourcesContent":["import { request } from '../Request';\nimport { SpotifyAlbum, SpotifyPlaylist, SpotifyTrack } from './classes';\nimport { existsSync, readFileSync, writeFileSync } from 'node:fs';\n\nlet spotifyData: SpotifyDataOptions;\nif (existsSync('.data/spotify.data')) {\n    spotifyData = JSON.parse(readFileSync('.data/spotify.data', 'utf-8'));\n    spotifyData.file = true;\n}\n/**\n * Spotify Data options that are stored in spotify.data file.\n */\nexport interface SpotifyDataOptions {\n    client_id: string;\n    client_secret: string;\n    redirect_url?: string;\n    authorization_code?: string;\n    access_token?: string;\n    refresh_token?: string;\n    token_type?: string;\n    expires_in?: number;\n    expiry?: number;\n    market?: string;\n    file?: boolean;\n}\n\nconst pattern = /^((https:)?\\/\\/)?open\\.spotify\\.com\\/(?:intl\\-.{2}\\/)?(track|album|playlist)\\//;\n/**\n * Gets Spotify url details.\n *\n * ```ts\n * let spot = await play.spotify('spotify url')\n *\n * // spot.type === \"track\" | \"playlist\" | \"album\"\n *\n * if (spot.type === \"track\") {\n *      spot = spot as play.SpotifyTrack\n *      // Code with spotify track class.\n * }\n * ```\n * @param url Spotify Url\n * @returns A {@link SpotifyTrack} or {@link SpotifyPlaylist} or {@link SpotifyAlbum}\n */\nexport async function spotify(url: string): Promise<Spotify> {\n    if (!spotifyData) throw new Error('Spotify Data is missing\\nDid you forgot to do authorization ?');\n    const url_ = url.trim();\n    if (!url_.match(pattern)) throw new Error('This is not a Spotify URL');\n    if (url_.indexOf('track/') !== -1) {\n        const trackID = url_.split('track/')[1].split('&')[0].split('?')[0];\n        const response = await request(`https://api.spotify.com/v1/tracks/${trackID}?market=${spotifyData.market}`, {\n            headers: {\n                Authorization: `${spotifyData.token_type} ${spotifyData.access_token}`\n            }\n        }).catch((err: Error) => {\n            return err;\n        });\n        if (response instanceof Error) throw response;\n        const resObj = JSON.parse(response);\n        if (resObj.error) throw new Error(`Got ${resObj.error.status} from the spotify request: ${resObj.error.message}`);\n        return new SpotifyTrack(resObj);\n    } else if (url_.indexOf('album/') !== -1) {\n        const albumID = url.split('album/')[1].split('&')[0].split('?')[0];\n        const response = await request(`https://api.spotify.com/v1/albums/${albumID}?market=${spotifyData.market}`, {\n            headers: {\n                Authorization: `${spotifyData.token_type} ${spotifyData.access_token}`\n            }\n        }).catch((err: Error) => {\n            return err;\n        });\n        if (response instanceof Error) throw response;\n        const resObj = JSON.parse(response);\n        if (resObj.error) throw new Error(`Got ${resObj.error.status} from the spotify request: ${resObj.error.message}`);\n        return new SpotifyAlbum(resObj, spotifyData, false);\n    } else if (url_.indexOf('playlist/') !== -1) {\n        const playlistID = url.split('playlist/')[1].split('&')[0].split('?')[0];\n        const response = await request(\n            `https://api.spotify.com/v1/playlists/${playlistID}?market=${spotifyData.market}`,\n            {\n                headers: {\n                    Authorization: `${spotifyData.token_type} ${spotifyData.access_token}`\n                }\n            }\n        ).catch((err: Error) => {\n            return err;\n        });\n        if (response instanceof Error) throw response;\n        const resObj = JSON.parse(response);\n        if (resObj.error) throw new Error(`Got ${resObj.error.status} from the spotify request: ${resObj.error.message}`);\n        return new SpotifyPlaylist(resObj, spotifyData, false);\n    } else throw new Error('URL is out of scope for play-dl.');\n}\n/**\n * Validate Spotify url\n * @param url Spotify URL\n * @returns\n * ```ts\n * 'track' | 'playlist' | 'album' | 'search' | false\n * ```\n */\nexport function sp_validate(url: string): 'track' | 'playlist' | 'album' | 'search' | false {\n    const url_ = url.trim();\n    if (!url_.startsWith('https')) return 'search';\n    if (!url_.match(pattern)) return false;\n    if (url_.indexOf('track/') !== -1) {\n        return 'track';\n    } else if (url_.indexOf('album/') !== -1) {\n        return 'album';\n    } else if (url_.indexOf('playlist/') !== -1) {\n        return 'playlist';\n    } else return false;\n}\n/**\n * Fuction for authorizing for spotify data.\n * @param data Sportify Data options to validate\n * @returns boolean.\n */\nexport async function SpotifyAuthorize(data: SpotifyDataOptions, file: boolean): Promise<boolean> {\n    const response = await request(`https://accounts.spotify.com/api/token`, {\n        headers: {\n            'Authorization': `Basic ${Buffer.from(`${data.client_id}:${data.client_secret}`).toString('base64')}`,\n            'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        body: `grant_type=authorization_code&code=${data.authorization_code}&redirect_uri=${encodeURI(\n            data.redirect_url as string\n        )}`,\n        method: 'POST'\n    }).catch((err: Error) => {\n        return err;\n    });\n    if (response instanceof Error) throw response;\n    const resp_json = JSON.parse(response);\n    spotifyData = {\n        client_id: data.client_id,\n        client_secret: data.client_secret,\n        redirect_url: data.redirect_url,\n        access_token: resp_json.access_token,\n        refresh_token: resp_json.refresh_token,\n        expires_in: Number(resp_json.expires_in),\n        expiry: Date.now() + (resp_json.expires_in - 1) * 1000,\n        token_type: resp_json.token_type,\n        market: data.market\n    };\n    if (file) writeFileSync('.data/spotify.data', JSON.stringify(spotifyData, undefined, 4));\n    else {\n        console.log(`Client ID : ${spotifyData.client_id}`);\n        console.log(`Client Secret : ${spotifyData.client_secret}`);\n        console.log(`Refresh Token : ${spotifyData.refresh_token}`);\n        console.log(`Market : ${spotifyData.market}`);\n        console.log(`\\nPaste above info in setToken function.`);\n    }\n    return true;\n}\n/**\n * Checks if spotify token is expired or not.\n *\n * Update token if returned false.\n * ```ts\n * if (play.is_expired()) {\n *      await play.refreshToken()\n * }\n * ```\n * @returns boolean\n */\nexport function is_expired(): boolean {\n    if (Date.now() >= (spotifyData.expiry as number)) return true;\n    else return false;\n}\n/**\n * type for Spotify Classes\n */\nexport type Spotify = SpotifyAlbum | SpotifyPlaylist | SpotifyTrack;\n/**\n * Function for searching songs on Spotify\n * @param query searching query\n * @param type \"album\" | \"playlist\" | \"track\"\n * @param limit max no of results\n * @returns Spotify type.\n */\nexport async function sp_search(\n    query: string,\n    type: 'album' | 'playlist' | 'track',\n    limit: number = 10\n): Promise<Spotify[]> {\n    const results: Spotify[] = [];\n    if (!spotifyData) throw new Error('Spotify Data is missing\\nDid you forget to do authorization ?');\n    if (query.length === 0) throw new Error('Pass some query to search.');\n    if (limit > 50 || limit < 0) throw new Error(`You crossed limit range of Spotify [ 0 - 50 ]`);\n    const response = await request(\n        `https://api.spotify.com/v1/search?type=${type}&q=${query}&limit=${limit}&market=${spotifyData.market}`,\n        {\n            headers: {\n                Authorization: `${spotifyData.token_type} ${spotifyData.access_token}`\n            }\n        }\n    ).catch((err: Error) => {\n        return err;\n    });\n    if (response instanceof Error) throw response;\n    const json_data = JSON.parse(response);\n    if (type === 'track') {\n        json_data.tracks.items.forEach((track: any) => {\n            results.push(new SpotifyTrack(track));\n        });\n    } else if (type === 'album') {\n        json_data.albums.items.forEach((album: any) => {\n            results.push(new SpotifyAlbum(album, spotifyData, true));\n        });\n    } else if (type === 'playlist') {\n        json_data.playlists.items.forEach((playlist: any) => {\n            results.push(new SpotifyPlaylist(playlist, spotifyData, true));\n        });\n    }\n    return results;\n}\n/**\n * Refreshes Token\n *\n * ```ts\n * if (play.is_expired()) {\n *      await play.refreshToken()\n * }\n * ```\n * @returns boolean\n */\nexport async function refreshToken(): Promise<boolean> {\n    const response = await request(`https://accounts.spotify.com/api/token`, {\n        headers: {\n            'Authorization': `Basic ${Buffer.from(`${spotifyData.client_id}:${spotifyData.client_secret}`).toString(\n                'base64'\n            )}`,\n            'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        body: `grant_type=refresh_token&refresh_token=${spotifyData.refresh_token}`,\n        method: 'POST'\n    }).catch((err: Error) => {\n        return err;\n    });\n    if (response instanceof Error) return false;\n    const resp_json = JSON.parse(response);\n    spotifyData.access_token = resp_json.access_token;\n    spotifyData.expires_in = Number(resp_json.expires_in);\n    spotifyData.expiry = Date.now() + (resp_json.expires_in - 1) * 1000;\n    spotifyData.token_type = resp_json.token_type;\n    if (spotifyData.file) writeFileSync('.data/spotify.data', JSON.stringify(spotifyData, undefined, 4));\n    return true;\n}\n\nexport async function setSpotifyToken(options: SpotifyDataOptions) {\n    spotifyData = options;\n    spotifyData.file = false;\n    await refreshToken();\n}\n\nexport { SpotifyTrack, SpotifyAlbum, SpotifyPlaylist };\n"]}